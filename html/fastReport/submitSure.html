<!DOCTYPE html>
<html>

<head>
	<meta name="viewport" content="width=device-width, minimum-scale=1, maximum-scale=1">
	<meta charset="UTF-8">
	<title></title>
	<link rel="stylesheet" href="../../css/iuapmobile.um.css">
	<style>
		div.Artical>div {
			display: none;
			color: #555;
		}

		.um-tabbar.um-tabbar-underline {
			background-color: white;
		}

		div.Artical>div.active {
			display: block;
		}

		.flow p.title {
			font-size: 0.28rem;
			color: #333;
			padding: 0.2rem 0.2rem;
		}

		.contentFlow {
			margin-top: 0.2rem;
			padding-left: 0.6rem;
			overflow: hidden;
		}

		.contentFlow .listItem {
			border-left: 2px dotted #ddd;
			margin-left: 0.34rem;
			min-height: 2rem;
			padding-right: 0.3rem;
		}

		.contentFlow .listItem:last-child {
			border-left: 0px dotted #ddd;
		}

		.contentFlow .listItem:first-child {
			margin-top: 0.4rem;
		}

		.contentFlow .listItem p.top {
			color: #039be5;
			font-size: 0.32rem;
			padding-left: 0.24rem;
		}

		.contentFlow .listItem .inside {
			position: relative;
			padding-bottom: 0.32rem;
			border-bottom: 1px solid #f7f7f7;
		}

		.contentFlow .listItem .inside img.true {
			position: absolute;
			z-index: 100;
			top: 0.06rem;
			left: -0.14rem;
			width: 0.28rem;
		}

		.contentFlow .listItem:first-child .inside img.true {
			top: 0.02rem;
		}

		.contentFlow .listItem p.content {
			color: #9e9e9e;
			font-size: 0.28rem;
			padding-left: 0.24rem;
		}

		ul.um-tabbar li a {
			display: inline-block;
			line-height: 0.7rem;
			height: 0.7rem;
		}

		.listContent:first-child {
			margin-top: 0px;
		}

		.listContent {
			border-radius: 5px;
			margin-top: 0.2rem;
			background: #fff;
		}

		.listContent p.title {
			color: #333;
			font-size: 0.36rem;
			position: relative;
			line-height: 0.9rem;
			padding-left: 0.5rem;
		}

		.listContent p {
			padding: 0 0.54rem;
			font-size: 0.28rem;
			line-height: 0.9rem;
		}

		.listContent p span {
			color: #424242;
		}

		.um-tabbar-underline>li.active {
			color: #039be5;
			border-color: #039be5;
		}

		.listContent p.title:before {
			content: "";
			width: 3px;
			height: 0.32rem;
			background: #039be5;
			position: absolute;
			left: 0.4rem;
			top: 0.26rem;
		}

		.um-tabbar-underline>li.active>a {
			color: #039be5;
		}

		.listContent p {
			line-height: 0.9rem;
			border-bottom: 1px solid #f7f7f7;
			color: #666;
			font-size: 0.32rem;
		}
	</style>
</head>

<body>
	<div class="um-win" id="submit" v-cloak>
		<ul class="um-tabbar um-tabbar-underline um-tabbar-switch">
			<li data-tar='.base' class="active tc">
				<a>基本信息</a>
			</li>
			<li class=" tc" data-tar='.flow'>
				<a>评审流程</a>
			</li>
		</ul>
		<div class="um-content">
			<div class="Artical">
				<div class="base  active">
					<div class="list listContent">

						<p class="title">基本信息</p>
						<p class="pl10 pr10">客户信息
							<span class="fr">{{dataList?dataList.prjBscInfo.cstNm:""}}</span>
						</p>
						<p class="pl10 pr10">合同编号
							<span class="fr">{{dataList?dataList.prjBscInfo.lsCntNo:""}}</span>
						</p>
						<p class="pl10 pr10">业务类型
							<span class="fr">{{dataList?dataList.prjBscInfo.bizTypNm:""}}</span>
						</p>
						<p class="pl10 pr10">项目类型
							<span class="fr">{{dataList?dataList.prjBscInfo.prjTypCdNm:""}}</span>
						</p>
						<!-- <p class="pl10 pr10">放款规则<span class="fr">{{dataList?dataList.prjBscInfo.prjTypCdNm:""}}</span></p> -->
						<p class="pl10 pr10">客户经理
							<span class="fr">{{dataList?dataList.prjBscInfo.cstMgrNm:""}}</span>
						</p>
					</div>
					<div class="list listContent">
						<p class="title pl10">车辆信息</p>
						<p class="pl10 pr10">经销商
							<span class="fr">{{dataList?dataList.prjBscInfo.prjEquBscInfo.splNm:""}}</span>
						</p>
						<p class="pl10 pr10">品牌类型
							<span class="fr">{{dataList&&(dataList.prjBscInfo.prjEquBscInfo.isNew=="1")?"二手车":"新车"}}</span>
						</p>
						<p class="pl10 pr10">品牌
							<span class="fr">{{dataList?dataList.prjBscInfo.prjEquBscInfo.braNm:""}}</span>
						</p>
						<p class="pl10 pr10">车系
							<span class="fr">{{dataList?dataList.prjBscInfo.prjEquBscInfo.equSet:""}}</span>
						</p>
						<p class="pl10 pr10">车型号
							<span class="fr">{{dataList?dataList.prjBscInfo.prjEquBscInfo.equMdl:""}}</span>
						</p>
						<p class="pl10 pr10">车辆识别代号
							<span class="fr">{{dataList?dataList.prjBscInfo.prjEqiDtlCar.vinNo:""}}</span>
						</p>
						<p class="pl10 pr10">发动机号
							<span class="fr">{{dataList?dataList.prjBscInfo.prjEqiDtlCar.engNo:""}}</span>
						</p>
						<p class="pl10 pr10">是否二手车
							<span class="fr">{{dataList&&(dataList.prjBscInfo.prjEquBscInfo.isNew=="1")?"是":"否"}}</span>
						</p>
						<!-- <p class="pl10 pr10">二手车里程数(公里)<span class="fr">{{dataList?dataList.prjBscInfo.prjEqiDtlCar.usedCarMil:""}}</span></p> -->
						<!-- <p class="pl10 pr10">二手车首次登记日期<span class="fr">{{dataList?new Date(dataList.prjBscInfo.prjEqiDtlCar.usedCarReg).format("yyyy-MM-dd"):""}}</span></p> -->
						<p class="pl10 pr10">交易城市
							<span class="fr">{{dataList?dataList.prjBscInfo.rgnReCd.name:""}}-{{dataList?dataList.prjBscInfo.rgnPrCd.name:""}}-{{dataList?dataList.prjBscInfo.rgnCyCd.name:""}}-{{dataList?dataList.prjBscInfo.rgnToCd.name:""}}</span>
						</p>
						<p class="pl10 pr10">卖家姓名
							<span class="fr">{{dataList?dataList.prjBscInfo.prjEqiDtlCar.sellerNm:""}}</span>
						</p>
						<p class="pl10 pr10">卖家证件号
							<span class="fr">{{dataList?dataList.prjBscInfo.prjEqiDtlCar.idCardNo:""}}</span>
						</p>
						<p class="pl10 pr10">车身颜色
							<span class="fr">{{dataList?dataList.prjBscInfo.prjEqiDtlCar.carCl:""}}</span>
						</p>
						<p class="pl10 pr10">车辆单价
							<span class="fr">{{dataList?dataList.prjBscInfo.prjEquBscInfo.equAmt:""}}</span>
						</p>
						<p class="pl10 pr10">留购价
							<span class="fr">{{dataList?dataList.prjBscInfo.prjEquBscInfo.rsrvPc:""}}</span>
						</p>
					</div>
					<div class="list listContent">
						<p class="title pl10">报价方案</p>
						<!-- <p class="pl10 pr10">产品方案<span class="fr">{{dataList?dataList.prjBscInfo.prjQuatPrps.lsPd:""}}-没找到</span></p>  -->
						<p class="pl10 pr10">还款期限
							<span class="fr">{{dataList?dataList.prjBscInfo.prjQuatPrps.lsPd:""}}</span>
						</p>
						<p class="pl10 pr10">还款期限单位
							<span class="fr">{{dataList?dataList.prjBscInfo.prjQuatPrps.lsPdUntNm:""}}</span>
						</p>
						<p class="pl10 pr10">贷款年利率(%)
							<span class="fr">{{dataList?dataList.prjBscInfo.prjQuatPrps.defAnnIntRatePct:""}}</span>
						</p>
						<p class="pl10 pr10">支付方式
							<span class="fr">{{dataList?dataList.prjBscInfo.prjQuatPrps.payWay:""}}</span>
						</p>
						<p class="pl10 pr10">首付款比例(%)
							<span class="fr">{{dataList?dataList.prjBscInfo.prjQuatPrps.hirePct:""}}</span>
						</p>
						<p class="pl10 pr10">首付款
							<span class="fr">{{dataList?dataList.prjBscInfo.prjQuatPrps.hirePct*(dataList.prjBscInfo.prjQuatPrps.totLsItmAmt)/100:""}}</span>
						</p>
						<p class="pl10 pr10">保证金比例(%)
							<span class="fr">{{dataList?dataList.prjBscInfo.prjQuatPrps.bailPct:""}}</span>
						</p>
						<p class="pl10 pr10">保证金
							<span class="fr">{{dataList?dataList.prjBscInfo.prjQuatPrps.bailPct*(dataList.prjBscInfo.prjQuatPrps.totLsItmAmt)/100:""}}</span>
						</p>
						<p class="pl10 pr10">贴息金额
							<span class="fr">{{dataList?dataList.prjBscInfo.prjQuatPrps.txJe:""}}</span>
						</p>
						<p class="pl10 pr10">GPS是否安装
							<span class="fr">{{dataList?dataList.prjBscInfo.prjQuatPrps.gpsInsNm:""}}</span>
						</p>
						<div v-for="item in dataDetail">
							<p class="pl10 pr10" v-if="item.feeTypCd=='04'">咨询服务费
								<span class="fr">{{item.feeAmt}} </span>
							</p>
							<p class="pl10 pr10" v-else-if="item.feeTypCd=='10'">GPS费
								<span class="fr">{{item.feeAmt}}</span>
							</p>
							<p class="pl10 pr10" v-else-if="item.feeTypCd=='30'">购置税
								<span class="fr">{{item.feeAmt}}</span>
							</p>
							<p class="pl10 pr10" v-else-if="item.feeTypCd=='32'">保险费
								<span class="fr">{{item.feeAmt}}</span>
							</p>
							<p class="pl10 pr10" v-else-if="item.feeTypCd=='51'">精品装潢
								<span class="fr">{{item.feeAmt}}</span>
							</p>
							<p class="pl10 pr10" v-else> </p>
							<!-- <p class="pl10 pr10">每期租金<span class="fr">{{dataList?dataList.prjQuatProps.prjQuatPrpsPaySchList[0].rntAmt:""}}</span></p> -->
						</div>
						<!-- <p class="pl10 pr10">GPS类型<span class="fr">{{dataList?dataList.prjBscInfo.prjQuatPrps.lsPdUntNm:""}}--只有2，3</span></p>

								<p class="pl10 pr10">GPS费<span class="fr">{{dataList?dataList.prjBscInfo.prjQuatPrps.lsPdUntNm:""}}--未找到</span></p>
								<p class="pl10 pr10">购置税<span class="fr">{{dataList?dataList.prjBscInfo.prjQuatPrps.lsPdUntNm:""}}--未找到</span></p>
								<p class="pl10 pr10">保险费<span class="fr">{{dataList?dataList.prjBscInfo.prjQuatPrps.lsPdUntNm:""}}--未找到</span></p>
								<p class="pl10 pr10">精品装潢<span class="fr">{{dataList?dataList.prjBscInfo.prjQuatPrps.lsPdUntNm:""}}--未找到</span></p>
								<p class="pl10 pr10">每期租金<span class="fr">{{dataList?dataList.prjBscInfo.prjQuatPrps.lsPdUntNm:""}}--未找到</span></p> -->



					</div>
				</div>
				<div class="flow">
					<div id="flowContent"></div>
					<p class="title  um-bgc-white" v-show="JBPM_ID">流程ID：{{JBPM_ID.pdNo}} </p>
					<div class="contentFlow um-bgc-white">
						<div class="listItem" v-for="(item,index) in JBPM_ID.histoicFlowList">
							<div class="inside">
								<img src="../../img/true.png" class="true" alt="" />
								<p class="top">{{item.assigneeName}}</p>
								<!-- <p class="content"> {{item.assigneeName}} </p> -->
								<p class="content">审批意见：{{item.comment?item.comment:"无"}} </p>
								<p class="content">任务历时： {{item.durationTime}}</p>
							</div>
						</div>
					</div>


				</div>
			</div>
		</div>
		<div class="um-footer">
			<button class="btn" @click="opensubmitFinanl">提交评审</button>
		</div>
	</div>
	<script src="../../js/summer.js"></script>
	<script src="../../js/jquery.min.js"></script>
	<script src="../../js/font.js"></script>
	<script src="../../js/vue.js"></script>
	<script src="../../js/common.js"></script>
	<script src="../../js/Frameworks/iuapmobile.frameworks.ui.js"></script>
	<script>
		var submitSure = new Vue({
			el: '#submit',
			data:function() {
				return {
					dataList: "",
					dataSchemeList:"",
					project_id:"",
					JBPM_ID_NM:"",
					JBPM_ID:"",
					dataDetail:[]
				}
			},
			methods: {
				getData:function(id) {
					var self = this;
					ajaxRequest({
						type: 'post',
						url: 'appservice/project/prjbscinfo/getById.do',
						param: {
							"id": id,
						}
					}, function(res) {
						summer.hideProgress();
						if (res.data.flag == 1) {
							self.dataList = res.data.datas;
						self.dataDetail=res.data.datas.prjBscInfo.prjQuatPrps.prjQuatPrpsFeeList
							//self.getSchemeData(self.project_id);
							console.log(self.dataList);
						}
					}, function(err) {
						alert(err);
						console.log(err);
						summer.hideProgress();
					});

				},
				getJBPMData:function(id){
					var self = this;
						ajaxRequest({
							type: 'get',
							url: 'appservice/project/prjbscinfo/showPrjAct.do',
							param: {
								"id": id,
							}
						}, function(res) {
							summer.hideProgress();
							if (res.data.flag == 1) {
								self.JBPM_ID=res.data.datas;
								console.log(res);
							}
						}, function(err) {
							alert(err);
							console.log(err);
							summer.hideProgress();
						});

				},
				opensubmitFinanl:function() {
					var _this = this;
					summer.showProgress()
					ajaxRequest({
						type: 'get',
						url: 'appservice/project/prjbscinfo/addFlowStart.do',
						param: {
							"id": _this.project_id,
						}
					}, function (res) {
						console.log("res", JSON.stringify(res));
						if (res.data.flag == 1) {
							var resultData = res.data.datas
							summer.hideProgress()
							summer.openWin({
								id: 'finanlSubmit',
								url: 'html/fastReport/finanlSubmit.html',
								create: false,
								type: 'actionBar',
								addBackListener: true,
								pageParam: {
									prjPrdInfo_id: resultData.prjPrdInfo.id,
									project_Id: _this.project_id,
									cstNm: resultData.cstNm,
									bizTypCdNm: resultData.PLATFORM,
									procNm: resultData.procNm,
									equQty: resultData.prjPrdInfo.equQty,
									equNm: resultData.prjPrdInfo.equNm,
									guidePc: resultData.prjPrdInfo.equAmt
								},
								actionBar: {
									title: "提交评审",
									titleColor: "#ffffff",
									backgroundColor: "#039BE5",
									leftItem: {
										image: "img/back.png",
										method: 'keyBack()',
										text: "关闭",
										textColor: "#ffffff"
									}
								}
							});
						}
					}, function (err) {

					})

				}
			}
		});
		summerready = function () {
			var project_Id = summer.pageParam.project_Id;
			submitSure.project_id = project_Id;
			submitSure.getData(project_Id);
			submitSure.getJBPMData(project_Id);
		};
		$(function() {
		/*导航更换js*/
		$('ul.um-tabbar-switch  li').click(function() {
			$(this).addClass('active').siblings('.active').removeClass('active');
			var tar = $(this).attr('data-tar');
			$(tar).addClass('active').siblings('.active').removeClass('active');
		});
	});
	</script>
</body>

</html>
